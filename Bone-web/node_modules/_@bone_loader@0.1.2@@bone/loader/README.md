# 简单的js模块加载器

## 使用方式
本加载器不需要修改js文件的打包方式，按照以下方式使用。

### 1. 引入加载器
```html
    <script src="xxx/loader.js"></script>
```
加载器引入之后，在window上会挂载一个全局的loader函数对象。

### 2. 注册模块
在每个js文件中，加入以下代码
```javascript
    loader.register(module);
```

### 3. 使用模块
```javascript
    const module = loader(moduleId);
```
这里的moduleId默认是js的url地址

### 4. 异步加载一个js文件
```javascript
    loader.async("xxx/yyy.js", function(module){
        // do something
    });
```

## 示例
### a.js
```javascript
    loader.register(1);
```

### b.js
```javascript
    loader.register(2);
```

### main.js
```javascript
    function load(url){
        return new Promise(function(resolve){
            loader.async(url, resolve);
        });
    }

    Promise.all([
        load("a.js"),
        load("b.js")
    ]).then(function(a, b){
        console.log(a + b === 3);
    });
```

## 插件开发
支持以插件的方式修改loader的行为，目前支持以下3个插件修改点

### load
加载一个模块
```javascript
loader.plugin("load", function(info){
    // 修改加载的url
    info.url = "xxx";
    return info;
});
```
### register
注册一个模块
```javascript
loader.plugin("register", function(info){
    // 修改模块ID
    info.moduleId = "xxx";
    return info;
});
```
### get
获取一个模块
```javascript
loader.plugin("get", function(info){
    // 修改模块ID
    info.moduleId = "xxx";
    return info;
});
```