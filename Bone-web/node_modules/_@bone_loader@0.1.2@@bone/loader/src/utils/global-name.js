import getCurrentScript from "./getCurrentScript";

const globalNameAttribute = "global-name";

/**
 * 根据script标签上的global-name属性指定loader全局访问的名称
 * @param {object} loader 
 */
export default function(loader){
    let currentScript = getCurrentScript();
    if(!currentScript){
        let scripts = document.getElementsByTagName("script");
        for(let i = 0, l = scripts.length; i < l; i ++){
            let script = scripts[i];
            if(script.getAttribute(globalNameAttribute)){
                currentScript = script;
                break;
            }
        }
    }

    if(currentScript){
        let globalName = currentScript.getAttribute(globalNameAttribute);
        if(globalName){
            window[globalName] = loader;
        }
    }
}